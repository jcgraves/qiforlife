---
import Layout from '../layouts/Layout.astro';
import { getCollection, getEntry } from 'astro:content';

// Load services page content
const hero = await getEntry('services-page', 'hero');
const whatToExpect = await getEntry('services-page', 'what-to-expect');
const cta = await getEntry('services-page', 'cta');

// Load services and sort by order
const services = await getCollection('services');
const sortedServices = services.sort((a, b) => a.data.order - b.data.order);

// Icon mapping for services
const iconMap: Record<string, string> = {
  acupuncture: '<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22v-7l-2-2"/><path d="M17 8v.8A6 6 0 0 1 13.8 14v0a6.5 6.5 0 0 1-3.8 1H8"/><path d="m2 2 20 20"/><path d="M12 12V2"/></svg>',
  electronic: '<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2 3 14h9l-1 8 10-12h-9l1-8z"/></svg>',
  facial: '<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="8" r="6"/><path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11"/></svg>',
  cupping: '<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z"/></svg>',
  moxibustion: '<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"/></svg>',
  guasa: '<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 3v7a6 6 0 0 0 6 6 6 6 0 0 0 6-6V3"/><path d="M4 21a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2"/><line x1="12" y1="16" x2="12" y2="21"/></svg>',
  tdp: '<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><path d="M12 1v2"/><path d="M12 21v2"/><path d="M4.22 4.22l1.42 1.42"/><path d="M18.36 18.36l1.42 1.42"/><path d="M1 12h2"/><path d="M21 12h2"/><path d="M4.22 19.78l1.42-1.42"/><path d="M18.36 5.64l1.42-1.42"/></svg>',
  herbs: '<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M7 21h10"/><path d="M12 21a9 9 0 0 0 9-9H3a9 9 0 0 0 9 9Z"/><path d="M11.38 12a2.4 2.4 0 0 1-.4-4.77 2.4 2.4 0 0 1 3.2-2.77 2.4 2.4 0 0 1 3.47-.63 2.4 2.4 0 0 1 3.37 3.37 2.4 2.4 0 0 1-1.1 3.7 2.51 2.51 0 0 1 .03 1.1"/><path d="m13 12-4.5-2"/><path d="M10.88 9.07a2.4 2.4 0 0 0-4 .5"/></svg>',
  hotstone: '<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M19 17v4"/><path d="M3 5h4"/><path d="M17 19h4"/></svg>',
  qigong: '<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>',
};
---

<Layout
  title="Services"
  description="Explore our acupuncture and Traditional Chinese Medicine services in Brentwood, TN. Acupuncture, cupping, moxibustion, Chinese herbs, and more."
>
  <!-- Hero Section -->
  <section class="page-hero">
    <div class="container">
      <span class="section-label">{hero?.data.sectionLabel}</span>
      <h1>{hero?.data.title}</h1>
      <p class="page-hero__subtitle">{hero?.data.subtitle}</p>
    </div>
  </section>

  <!-- Services Grid -->
  <section class="services-main section section--white">
    <div class="container">
      <div class="services-intro text-center">
        <p>{hero?.data.introText}</p>
      </div>

      <div class="services-grid">
        {sortedServices.map((service) => (
          <div class="service-card">
            <div class="service-card__icon">
              <Fragment set:html={iconMap[service.data.icon] || iconMap.acupuncture} />
            </div>
            <h3>{service.data.title}</h3>
            <p>{service.data.description}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- What to Expect -->
  <section class="expect section section--cream">
    <div class="container container--narrow">
      <div class="section-header">
        <span class="section-label">{whatToExpect?.data.sectionLabel}</span>
        <h2>{whatToExpect?.data.heading}</h2>
      </div>

      <div class="expect-content">
        {whatToExpect?.data.items.map((item: { title: string; description: string }) => (
          <div class="expect-item">
            <h3>{item.title}</h3>
            <p>{item.description}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="cta section section--sage">
    <div class="container container--narrow text-center">
      <h2>{cta?.data.heading}</h2>
      <p class="cta__text">{cta?.data.text}</p>
      <a href="/contact" class="btn btn--gold">{cta?.data.buttonText}</a>
    </div>
  </section>
</Layout>

<style>
  /* Page Hero */
  .page-hero {
    background-color: var(--color-charcoal);
    color: var(--color-warm-white);
    padding: var(--space-3xl) 0 var(--space-2xl);
    text-align: center;
  }

  .page-hero h1 {
    color: var(--color-warm-white);
    margin-bottom: var(--space-xs);
  }

  .page-hero__subtitle {
    font-size: 1.125rem;
    color: var(--color-gold);
    font-weight: 500;
    letter-spacing: 0.05em;
  }

  /* Services Intro */
  .services-intro {
    max-width: 700px;
    margin: 0 auto var(--space-2xl);
  }

  .services-intro p {
    font-size: 1.125rem;
    color: var(--color-warm-gray);
  }

  /* Services Grid */
  .services-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-lg);
  }

  .service-card {
    background: var(--color-cream);
    padding: var(--space-lg);
    border-radius: 4px;
    transition: all var(--transition-medium);
  }

  .service-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-lg);
  }

  .service-card__icon {
    width: 72px;
    height: 72px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, var(--color-sage-light) 0%, var(--color-sage) 100%);
    border-radius: 50%;
    color: var(--color-warm-white);
    margin-bottom: var(--space-md);
  }

  .service-card h3 {
    font-size: 1.25rem;
    margin-bottom: var(--space-sm);
  }

  .service-card p {
    color: var(--color-warm-gray);
    line-height: 1.7;
    margin: 0;
  }

  @media (max-width: 768px) {
    .services-grid {
      grid-template-columns: 1fr;
    }
  }

  /* What to Expect */
  .expect-content {
    display: flex;
    flex-direction: column;
    gap: var(--space-xl);
  }

  .expect-item {
    border-left: 4px solid var(--color-gold);
    padding-left: var(--space-lg);
  }

  .expect-item h3 {
    font-size: 1.25rem;
    margin-bottom: var(--space-sm);
  }

  .expect-item p {
    color: var(--color-warm-gray);
    margin: 0;
  }

  /* CTA */
  .cta__text {
    font-size: 1.125rem;
    max-width: 500px;
    margin: var(--space-md) auto var(--space-xl);
  }
</style>
